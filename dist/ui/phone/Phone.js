import e,{useState as t,useRef as a,useEffect as n}from"react";import l from"../../assets/icons/cross/CrossIcon.js";import r from"../../assets/icons/downFillArrow/DownFillArrow.js";import o from"../spinner/Spinner.js";import s from"../../utils/classNames.js";import c from"react-select";import i from"./phone.module.scss.js";import"./phone_custom.scss.js";const m=({label:m,size:p="md",name:u,disabled:d,allowClear:_,error:f,helpText:h,loaderColor:g,value:E,onPhoneValue:v,onBlur:N,onFocus:y,onClear:b})=>{const[w,j]=t(""),[x,C]=t(!1),[F,z]=t(!1),[A,O]=t({}),[S,T]=t([]),[k,q]=t([]),B=a(null);return n((()=>{(async()=>{try{C(!0);const e=await fetch("http://graph.soppiya.biz/data",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({query:"query Get_countries {\n  get_countries {\n    _id\n    name\n    flag_icon\n    phone {\n      dialing_code\n      format\n    }\n  }\n}",variables:{},operationName:"Get_countries"})}),{data:{get_countries:t}}=await e.json();C(!1);const a=t.map((e=>({value:e._id,label:`${e.name} (${e.phone.dialing_code})`})));q(t),T(a)}catch(e){return e}})()}),[]),n((()=>{if(!k.length||!E)return;E?.phone&&j(E.phone);const e=k.find((e=>e._id===E.country));E?.country&&O(e)}),[E,x]),e.createElement("div",null,m&&e.createElement("div",{className:i.label_action_wrapper},m&&e.createElement("label",{className:s(i.label_text)},m)),k.length&&A?.name?e.createElement(e.Fragment,null,e.createElement("div",{className:s(i.phone_wrapper,i[p+"_input"])},e.createElement("div",{className:s(i.flag_wrapper,i[p+"_input"])},e.createElement("button",{className:s(i.prefix),type:"button",onClick:()=>{z((e=>!e))}},e.createElement("img",{src:A.flag_icon,alt:"country"}),e.createElement("span",{className:i.fill_arrow},e.createElement(r,null))),e.createElement("div",{className:i.country_code},e.createElement("label",{htmlFor:"telField"},A.phone.dialing_code))),e.createElement("div",{className:i.wrapper},e.createElement("div",{className:s(i.input_field_wrapper)},e.createElement("input",{name:u,type:"text",placeholder:A.phone.format,value:w,disabled:d,onChange:e=>{const t=A.phone.format.replace(/[\s()-]/g,"");for(let a=0;a<e.target.value.length;a++)if("X"!=t[a]){if(e.target.value[a]!==t[a])return}else if(isNaN(e.target.value[a]))return;j(e.target.value),e.target.value.length===t.length&&"function"==typeof v&&v({phone:e.target.value,country:A._id})},onBlur:N,onFocus:y,className:s(i.input_field,f&&f.status&&i.error_style,i.prefix_icon_padding),id:"telField",ref:B}),_&&e.createElement("button",{className:s(i.cross_icon),onClick:b,type:"button"},e.createElement(l,null))),h&&e.createElement("p",{className:i.help_text},h),f&&f.status&&e.createElement("p",{className:i.error_text}," ",f.message," ")),e.createElement("div",{className:i.select},e.createElement(c,{options:S,value:A._id,onChange:e=>(e=>{const t=k.find((t=>t._id===e.value));O(t),z(!1),B.current.focus()})(e),menuIsOpen:F,className:s(i.custom_select)})))):e.createElement("div",{className:s(i.select_field,i.spinner_center,i[p+"_input"])},e.createElement(o,{size:"xsm",color:g})))};export{m as default};
//# sourceMappingURL=Phone.js.map
